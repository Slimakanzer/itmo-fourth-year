# Лабораторная работа 3

**Название:** "Разработка драйверов сетевых устройств"

**Цель работы:** Получить знания и навыки разработки драйверов сетевых интерфейсов для операционной системы Linux.

**Выполнили:** Ларочкин Глеб игоревич PЗ400, Шуст Иван Владимирович P3400

## Описание функциональности драйвера

Драйвер создает:
- Сетевой интерфейс `lab5`, который наследует настройки от родительского интерфейса
- Файл-интерфейс для устройства `/proc/var5` с правами *0444*

Драйвер выводит в кольцевой буфер информацию о пакетах, длина которых меньше 70 байт:
- Общий размер пакета
- Размер данных
- Формат сообщения: `[var5]: Total len: 73, Data len: 53`

При чтении файла `/proc/var5` выводится
- Количество пакетов, длина которых меньше 70 байт
- Количество пакетов, не подошедших под прошлое условие
- Формат сообщения: `[var5]: success packets: 36, dropped packets: 21`

## Инструкция по сборке

1. Перейдите в директортю `io-systems/lab3`
2. Соберите программу
    > make
3. Проверяем доступные сетевые интерфейсы:
    > ifconfig
4. Добавляем драйвер в ядро, наследуем от интерфейса (в моем случае *enp0s3*)
    > insmod var5.ko link=enp0s3

## Примеры использования

Проверка наличия интерфейса `var5`
```bash
$ ifconfig
var5: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet xxx.xxx.xxx.xxx  netmask 255.255.255.0  broadcast xxx.xxx.xxx.xxx
        inet6 XXXX::XXXX:XXXX:XXXX:XXXX  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:f1:40:5d  txqueuelen 1000  (Ethernet)
        RX packets 44  bytes 2134 (2.1 KB)
        RX errors 0  dropped 24  overruns 0  frame 0
        TX packets 72  bytes 5211 (5.2 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

Проверка сообщений в кольцевом буфере
```bash
$ ping google.com
$ dmesg
[var5]: Total len: 84, Data len: 64
```

Проверка сообщения в файле-интерфейсе `/proc/var5`
```bash
$ cat /proc/var5
[var5]: success packets: 930, dropped packets: 649
```
